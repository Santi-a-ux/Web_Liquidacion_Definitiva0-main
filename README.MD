# Calculadora de L4. **Panel de Administraci√≥n:** Dashboard principal con navegaci√≥n a todas las funcionalidades administrativas

¬øTe ha tocado calcular liquidaciones laborales y terminas con dolor de cabeza entre tantos n√∫meros y fechas? Esta aplicaci√≥n nace de esa necesidad real que tienen las empresas, contadores y departamentos de recursos humanos de hacer estos c√°lculos de manera r√°pida, precisa y sin errores.

Cuando un empleado termina su contrato laboral, hay que calcular exactamente cu√°nto se le debe pagar: vacaciones, cesant√≠as, prima de servicios, indemnizaci√≥n y descontar la retenci√≥n en la fuente. Son muchos factores y cualquier error puede traer problemas legales o inconformidades.

Esta herramienta automatiza todo ese proceso tedioso, cumpliendo con la legislaci√≥n laboral colombiana vigente, para que puedas concentrarte en lo importante en lugar de estar haciendo c√°lculos manuales que pueden fallar.

## Funcionalidades Principales

1. **Agregar Empleado:** Registrar empleados con datos completos (nombre, apellido, documento, correo, tel√©fono, fechas laborales, salario) OK FUNCIONA
2. **Consultar Empleado:** B√∫squeda por ID con visualizaci√≥n completa de datos personales y liquidaciones asociadas OK FUNCIONA
3. **Modificar Empleado:** Actualizaci√≥n de informaci√≥n personal y laboral del empleado OK FUNCIONA
4. **Eliminar Empleado:** Eliminaci√≥n segura con validaci√≥n de integridad referencial OK FUNCIONA
5. **Calcular Liquidaci√≥n:** C√°lculo autom√°tico de todos los componentes (indemnizaci√≥n, vacaciones, cesant√≠as, intereses, prima, retenci√≥n) OK FUNCIONA
6. **Crear Liquidaci√≥n:** Generaci√≥n y almacenamiento de liquidaciones con ID √∫nico y relaci√≥n FK OK FUNCIONA
7. **Consultar Liquidaci√≥n:** Visualizaci√≥n detallada del desglose completo de liquidaci√≥n OK FUNCIONA
8. **Eliminar Liquidaci√≥n:** Eliminaci√≥n espec√≠fica por ID con validaciones OK FUNCIONA
9. **Panel de Administraci√≥n:** Dashboard con estad√≠sticas generales y vista consolidada OK FUNCIONA
10. **Listar Empleados:** Vista tabular de todos los empleados con accesos r√°pidos OK FUNCIONA
11. **Listar Liquidaciones:** Historial completo de liquidaciones procesadas OK FUNCIONA
12. **Validar Integridad Referencial:** Verificaci√≥n de relaciones entre usuarios y liquidaciones OK FUNCIONA
13. **Generar Reportes:** An√°lisis avanzado, gr√°ficos detallados y exportaci√≥n de datos en CSV OK FUNCIONA
14. **Autenticaci√≥n y Seguridad:** Validaci√≥n de entrada y prevenci√≥n de inyecci√≥n SQL OK FUNCIONA
15. **Sistema de Auditor√≠a:** Registro de operaciones y seguimiento de cambios en el sistema OK FUNCIONA 

## Tipos de Usuarios del Sistema

### üîß Administrador (Recursos Humanos)
**Acceso completo al sistema con las siguientes capacidades:**

- OK **Panel de Administraci√≥n:** Dashboard con estad√≠sticas completas, reportes financieros y m√©tricas del sistema
- OK **Gesti√≥n Completa de Empleados:** Crear, consultar, modificar y eliminar empleados
- OK **Gesti√≥n Completa de Liquidaciones:** Crear, consultar y eliminar liquidaciones
- OK **Vista Consolidada:** Acceso a listados completos y gesti√≥n masiva
- OK **Operaciones Cr√≠ticas:** Permisos para eliminar registros con validaciones de seguridad
- OK **An√°lisis y Estad√≠sticas:** Generaci√≥n de reportes, m√©tricas financieras y an√°lisis del sistema
- OK **Auditor√≠a del Sistema:** Seguimiento completo de operaciones realizadas

### üë§ Asistente Administrativo
**Acceso limitado con funcionalidades b√°sicas:**

- OK **Consultar Informaci√≥n:** Ver datos espec√≠ficos de empleados
- OK **Crear Liquidaciones:** Calcular liquidaciones para empleados existentes
- OK **Ver Resultados:** Consultar liquidaciones ya procesadas
- OK **Registrar Empleados:** Agregar nuevos empleados al sistema
- ERROR **Sin Panel Admin:** No acceso a estad√≠sticas generales del sistema
- ERROR **Sin Eliminaci√≥n:** No puede eliminar empleados ni liquidaciones
- ERROR **Sin Vista Consolidada:** No acceso a listados completos de gesti√≥n

### üìä Comparaci√≥n de Permisos

| Funcionalidad | Administrador (RRHH) | Asistente Administrativo |
|---------------|:--------------------:|:------------------------:|
| Dashboard administrativo | OK | ERROR |
| Generar reportes avanzados | OK | ERROR |
| Agregar empleados | OK | OK |
| Consultar empleados | OK | OK |
| Modificar empleados | OK | ERROR |
| Eliminar empleados | OK | ERROR |
| Crear liquidaciones | OK | OK |
| Consultar liquidaciones | OK | OK |
| Eliminar liquidaciones | OK | ERROR |
| Ver listados completos | OK | ERROR |
| Sistema de auditor√≠a | OK | ERROR |
| Exportar datos CSV | OK | ERROR |

## Detalles T√©cnicos de Funcionalidades Clave

### üßÆ C√°lculo Autom√°tico de Liquidaci√≥n
- **Indemnizaci√≥n:** M√°ximo 12 meses, 20 d√≠as por a√±o trabajado seg√∫n legislaci√≥n colombiana
- **Vacaciones:** C√°lculo proporcional basado en d√≠as trabajados (base 720 d√≠as anuales)
- **Cesant√≠as:** 1 mes de salario por a√±o trabajado (base 360 d√≠as)
- **Intereses sobre Cesant√≠as:** 12% anual autom√°tico sobre cesant√≠as acumuladas
- **Prima de Servicios:** C√°lculo proporcional semestral (base 360 d√≠as)
- **Retenci√≥n en la Fuente:** Tabla UVT colombiana actualizada (UVT 2024: $39,205)

### üîí Validaci√≥n de Integridad Referencial
- Prevenci√≥n de eliminaci√≥n de usuarios con liquidaciones activas
- Verificaci√≥n autom√°tica de relaciones entre tablas
- Mantenimiento de consistencia en base de datos PostgreSQL
- Mensajes informativos sobre restricciones de eliminaci√≥n

### üõ°Ô∏è Seguridad del Sistema
- **Prevenci√≥n SQL Injection:** Uso de par√°metros seguros en todas las consultas
- **Validaci√≥n de Entrada:** Verificaci√≥n de tipos de datos y formatos
- **Manejo Seguro de Conexiones:** Cierre autom√°tico y gesti√≥n de pool de conexiones
- **Auditor√≠a Completa:** Registro de todas las operaciones cr√≠ticas del sistema

### Panel de Administraci√≥n
- **Dashboard Central:** Punto de acceso a todas las funcionalidades administrativas
- **Navegaci√≥n Intuitiva:** Acceso directo a gesti√≥n de empleados, liquidaciones y reportes
- **Estad√≠sticas B√°sicas:** Contadores de empleados y liquidaciones registradas
- **Interfaz Responsive:** Dise√±o optimizado para desktop y dispositivos m√≥viles

### M√≥dulo de Reportes Avanzados
- **Acceso Dedicado:** P√°gina especializada accesible desde el Panel de Administraci√≥n
- **An√°lisis Salarial:** Distribuci√≥n por rangos (bajo: <$2M, medio: $2M-$5M, alto: >$5M)
- **Rankings:** Top empleados ordenados por salario base
- **Componentes de Liquidaci√≥n:** An√°lisis detallado de indemnizaciones, cesant√≠as, vacaciones, etc.
- **Resumen Ejecutivo:** Totales, promedios y m√©tricas clave del sistema
- **Exportaci√≥n CSV:** Descarga completa de datos para an√°lisis externo
- **Interfaz Avanzada:** Gr√°ficos, estad√≠sticas detalladas y herramientas de an√°lisis

## Requisitos del Sistema

- Python 3.x instalado
- PostgreSQL 13+ (base de datos en Neon Cloud)
- Flask y dependencias [`pip install flask psycopg2-binary`]
- Conexi√≥n a internet para base de datos remota

## Configuraci√≥n y Uso

### Instalaci√≥n

1. Clona este repositorio en tu m√°quina local:
    ```bash
    git clone https://github.com/tu-usuario/tu-repositorio
    ```

2. Instala las dependencias necesarias:
    ```bash
    pip install flask psycopg2-binary
    ```

3. Configura la base de datos:
    - Edita `SecretConfig.py` con las credenciales de tu base de datos PostgreSQL
    - Ejecuta los scripts SQL en la carpeta `sql/` para crear las tablas necesarias

4. Ejecuta la aplicaci√≥n web:
    ```bash
    python app.py
    ```

5. Abre tu navegador web y ve a `http://127.0.0.1:5000/`

### Acceso al Sistema

**Usuarios de Prueba:**
- **Administrador RRHH:** usuario: `admin` | contrase√±a: `admin123`
- **Asistente Administrativo:** usuario: `asistente` | contrase√±a: `asistente123`

### Navegaci√≥n Principal

1. **P√°gina de Login:** Autenticaci√≥n con validaci√≥n de roles
2. **Dashboard Principal:** Diferentes vistas seg√∫n el rol del usuario
3. **Panel de Administraci√≥n:** Solo para Administradores RRHH
4. **Generar Reportes:** M√≥dulo dedicado de an√°lisis avanzado
5. **Gesti√≥n de Empleados:** Operaciones CRUD completas
6. **Gesti√≥n de Liquidaciones:** C√°lculo, creaci√≥n y consulta

## Funcionamiento

### Agregar Empleado

1. Navega a `http://127.0.0.1:5000/agregar_usuario`.
2. Llena el formulario con la informaci√≥n del empleado.
3. Haz clic en "Agregar Empleado".
4. Si el empleado se agrega correctamente, ver√°s un mensaje de confirmaci√≥n en la p√°gina.

### Crear Liquidaci√≥n

1. Navega a `http://127.0.0.1:5000/agregar_liquidacion`.
2. Ingresa el ID del empleado para el cual deseas crear la liquidaci√≥n.
3. Haz clic en "Crear Liquidaci√≥n".
4. Si la liquidaci√≥n se crea correctamente, ver√°s un mensaje de confirmaci√≥n con el total a pagar y ser√°s redirigido a la p√°gina principal.

### Consultar Empleado

1. Navega a `http://127.0.0.1:5000/consultar_usuario`.
2. Ingresa el ID del empleado que deseas consultar.
3. Haz clic en "Consultar".
4. Si el empleado existe, ver√°s su informaci√≥n y la de su liquidaci√≥n.

### Eliminar Empleado

1. Navega a `http://127.0.0.1:5000/eliminar_usuario`.
2. Ingresa el ID del empleado que deseas eliminar.
3. Haz clic en "Eliminar Empleado".
4. Si el empleado se elimina correctamente, ver√°s un mensaje de confirmaci√≥n.
5. Tener en cuenta que el empleado no podr√° ser eliminado si a√∫n no se ha eliminado su liquidaci√≥n.

### Eliminar Liquidaci√≥n

1. Navega a `http://127.0.0.1:5000/eliminar_liquidacion`.
2. Ingresa el ID de la liquidaci√≥n que deseas eliminar.
3. Haz clic en "Eliminar Liquidaci√≥n".
4. Si la liquidaci√≥n se elimina correctamente, ver√°s un mensaje de confirmaci√≥n.

## Pruebas y Calidad de C√≥digo

Para ejecutar las pruebas unitarias, utiliza el siguiente comando en el directorio ra√≠z:

```bash
python -m unittest discover tests mirar si funciona
```

### üìä Evidencias de Pruebas

El proyecto cuenta con una estrategia integral de pruebas que incluye:
- **250+ pruebas** automatizadas (unitarias, integraci√≥n, E2E)
- **85%+ de cobertura** de c√≥digo reportada por SonarQube
- M√∫ltiples frameworks: pytest, Cypress, Selenium IDE, Serenity BDD
- Patr√≥n Screenplay implementado

**üìö Documentaci√≥n de Pruebas:**
- **[VALIDACION_CRITERIOS_PRUEBAS.md](VALIDACION_CRITERIOS_PRUEBAS.md)** - ‚≠ê **Validaci√≥n completa de criterios (110/110 - 100%)**
- **[GUIA_PRESENTACION_PRUEBAS.md](GUIA_PRESENTACION_PRUEBAS.md)** - Gu√≠a completa para presentar evidencias de pruebas
- **[test/README.md](test/README.md)** - Documentaci√≥n t√©cnica de frameworks
- **[ANALISIS_PRUEBAS.md](ANALISIS_PRUEBAS.md)** - An√°lisis detallado de implementaci√≥n

Para m√°s informaci√≥n sobre las pruebas, consulta la carpeta `test/` y los documentos mencionados.

## Licencia

Este proyecto est√° bajo la licencia MIT. Consulta el archivo LICENSE para obtener m√°s detalles.

## Desarrolladores encargados 
- David Rivera Masmela
- Santiago Gutierrez Correa
